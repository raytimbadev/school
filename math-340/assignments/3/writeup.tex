\documentclass[letterpaper,11pt]{article}

\author{Jacob Thomas Errington}
\title{Assignment \#3\\Discrete structures 2 -- MATH 340}
\date{8 March 2017}

\usepackage[margin=2.0cm]{geometry}
\usepackage{amsmath,amssymb,amsthm}

\newtheorem{prop}{Proposition}
\DeclareMathOperator{\Prob}{P}
\renewcommand{\P}[1]{\Prob{\parens{#1}}}
\DeclareMathOperator{\prob}{p}
\newcommand{\p}[2][]{%
    \def\temp{#2}
    \ifx\temp\empty
        \prob{\parens{#2}}
    \else
        \prob_{#1}{\parens{#2}}
    \fi
}
\DeclareMathOperator{\Expect}{\mathbb{E}}
\newcommand{\E}[1]{\Expect{\left[#1\right]}}
\DeclareMathOperator{\Var}{\mathbb{V}}
\newcommand{\V}[1]{\Var{\parens{#1}}}
\DeclareMathOperator{\BinOp}{Bin}
\newcommand{\Bin}[1]{\BinOp{\parens{#1}}}

\newcommand{\R}{\mathbb{R}}

\newcommand{\parens}[1]{\left(#1\right)}
\newcommand{\Union}{\bigcup}
\newcommand{\union}{\cup}
\newcommand{\Intersn}{\bigcap}
\newcommand{\intersn}{\cap}
\newcommand{\symdiff}{\,\Delta\,}
\newcommand{\fact}{!\,}
\newcommand{\given}{\;\vert\;}
\newcommand{\compl}{^c}
\newcommand{\inv}{^{-1}}
\newcommand{\compose}{\circ}

\renewcommand{\thesection}{Question \arabic{section}}
\newcommand{\question}{\section}

\newcommand{\dd}[1]{\frac{\mathrm{d}}{\operatorname{d} #1}}

\begin{document}

\maketitle

\question{Bayes's Theorem}

\begin{enumerate}
    \item
        This problem can be solved straighforwardly without Bayes's theorem
        by enumerating the sample space, $S = \{GG, BG, GB, BB\}$, where $BG$
        for instance denotes the outcome that the first child is male and the
        second is female. As we know that one child is male, this restricts the
        sample space to $S^\prime = \{BG, GB, BB\}$. In this space, the event
        $E = \text{``having one boy and one girl''}$ is true for both the $BG$
        and $GB$ outcomes.
        Hence, $\P{E} = \frac{2}{3}$.

    \item
        Let $Y$ denote the number of heads and $X$ denote the face value of the
        die. We wish to find $\P{X = 6 \given X = Y}$, so we apply Bayes's
        theorem.
        \begin{equation}
            \label{eq:bleh}
            \P{X = 6 \given X = Y} = \frac{
                \P{Y = X \given X = 6} \P{Y = X}
            }{
                \P{X = 6}
            }
        \end{equation}

        First, we know that $\P{Y = X \given X = 6}$ is simply the probability
        of getting heads six times $\P{Y = 6} = \frac{1}{2^6}$.

        Second, $\P{X = 6} = \frac{1}{6}$ is the probability of rolling a six.

        Finally, we find $\P{Y = X}$ by using the Law of Total Probability, as
        the different values of $X$ partition the space.
        \begin{equation*}
            \P{Y = X} = \sum_{i = 1}^6 {
                \P{Y = X \given X = i} \P{X = i}
            }
            =
            \sum_{i=1}^6 {
                \frac{1}{2^i} \frac{1}{6}
            }
            = \frac{21}{128}
        \end{equation*}

        Substituting into \eqref{eq:bleh} gives
        \begin{equation*}
            \P{X = 6 \given X = Y}
            = \frac{63}{4096} \sim 0.0154
        \end{equation*}

    \item
        Let $T$ be the event ``the new employee tests positive''. Then $\neg T$
        denotes the event that the employee tests negative.
        Let $D$ be the event ``the new employee uses the drug''.
        We know that $\P{T \given \neg D} = 0.02$
        and $\P{\neg T \given D} = 0.1$.
        We wish to find $\P{D \given T}$, the probability that the employee
        uses the drug given that they test positive.
        Applying Bayes's theorem gives
        \begin{equation*}
            \label{eq:employee-bayes}
            \P{D \given T} = \frac{
                \P{T \given D} \P{D}
            }{
                \P{T}
            }
        \end{equation*}

        Since the probability of testing negative when using the drug is $0.1$,
        the complement is the probability of testing positive when using the
        drug, i.e. $\P{T \given D} = 1 - \P{\neg T \given D} = 0.9$.

        All that remains to find is $\P{T}$. $\{D, \neg D\}$ partitions the
        space, so we apply the Law of Total Probability to obtain
        \begin{equation*}
            \P{T} = \P{T \given D} \P{D} + \P{T \given \neg D} \P{\neg D}
            = 0.9 \times 0.01 + 0.02 \times 0.99
            = 0.0288
        \end{equation*}

        Substituting these quantities into \eqref{eq:employee-bayes} gives
        \begin{equation*}
            \P{D \given T} = \frac{
                0.9 \times 0.01
            }{
                0.0288
            }
            = 0.3125
        \end{equation*}
\end{enumerate}

\question{Monty Hall variant}

Suppose without loss of generality that we picked door $A$ and that Monty
picked door $B$. Then the prize is behind either door $A$ or door $C$. Let
Let $A$, $B$, $C$ denote the events ``the prize is behind door $A$, $B$, $C$''
respectively. Let $M_i$ be the event that Monty selects door $i$.

We would like to compare the probability that the prize is behind door $A$
given that Monty chooses door $B$ \emph{and} that door $B$ does not contain the
prize $\P{A \given M_B \land \neg B}$
with the probability that the prize is behind door $C$ given that Monty chooses
door $B$ \emph{and} that door does  $\P{C \given M_B}$.

Applying Bayes's theorem, we have
\begin{equation}
    \label{eq:monty-bayes}
    \P{A \given M_B} = \frac{
        \P{M_B \given A} \P{A}
    }{
        \P{M_B}
    }
\end{equation}

The probability that Monty selects door $B$ given that the prize is behind door
$A$ is simply a half, since he selects from doors $A$ and $B$ with equal
probability. To find the probability that Monty selects door $B$ under no
assumptions, we use the Law of Total Probability.

\begin{equation*}
    \P{M_B}
    = \P{M_B \given A} \P{A}
    + \P{M_B \given B} \P{B}
    + \P{M_B \given C} \P{C}
    = \frac{1}{2} \times \frac{1}{3}
    + 0 \times \frac{1}{3}
    + \frac{1}{2} \times \frac{1}{3}
    = \frac{1}{3}
\end{equation*}

Substituting into \eqref{eq:monty-bayes} gives
\begin{equation*}
    \P{A \given M_B} = \frac{
        \frac{1}{2} \times \frac{1}{3}
    }{
        \frac{1}{3}
    }
    = \frac{1}{2}
\end{equation*}

By symmetry we have the same probability $\P{C \given M_B} = \frac{1}{2}$.

Hence, it does not matter whether we switch doors.

\question{Linearity of expectation}

Denote by $W_i$ the expected winnings of roll $i$.
Then the overall winnings from playing the game is $\sum_{i=1}^n W_i$.
Note that on the first roll, the winnings are zero because there is no previous
roll, so the overall winnings can be expressed as $\sum_{i=2}^n W_i$.

We would like to find $\P{W_i = 1}$ when $i > 1$.
Semantically, this probability is the same as the probability of the previous
roll's face value differing by one from the current roll's face value.
Denote by $R_i$ the face value of roll $i$. Then,
\begin{equation*}
    \P{R_i - R_{i-1} = 1 \lor R_{i-1} - R_i = 1}
    = \P{R_i - R_{i-1} = 1} + \P{R_{i-1} - R_i = 1}
\end{equation*}
as these events cannot happen at the same time.

For each of $\P{R_i - R_{i-1} = 1}$ and $\P{R_{i-1} - R_i = 1}$, there are $36$
outcomes overall (different values for $(R_i, R_{i-1})$ but only $10$ that
produce a difference of one, so the probability for each of these is
$\frac{10}{36}$.
Hence, the probability of winning $ 1\$ $ is $\frac{20}{36}$.

Next, we would like to find $\P{W_i = -1}$ when $i > 1$.
Again by the semantics, this is the same as the probability of rolling the same
value twice, i.e. $\P{R_i = R_{i-1}}$. We can partition the space on the value
of the previous roll and apply the Law of Total Probability.
\begin{equation*}
    \P{R_i = R_{i-1}}
    = \sum_{x = 1}^6 {
        \P{R_i = R_{i-1} \given R_{i-1} = x} \P{R_{i-1} = x}
    }
    = \frac{1}{6} \times \frac{1}{6}
    = \frac{1}{36}
\end{equation*}

Now we can find the expected winnings of roll $i$.
\begin{equation*}
    \E{W_i}
    = \frac{1}{36} \times (-1)
    + \frac{20}{36} \times 1
    = \frac{19}{36}
    \sim 0.53
\end{equation*}

Now we can use the linearity of expectation to compute the winnings of $n$
rolls,
\begin{equation*}
    \E{\sum_{i=2}^n W_i} = \sum_{i=2}^n \E{W_i} = (n-1)\frac{19}{36}
\end{equation*}

Note that the sum begins at two in order to discount the first roll, which
produces no winnings.

\end{document}
